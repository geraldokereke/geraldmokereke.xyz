<!DOCTYPE html>
<html><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>How to Dockerize Spring Boot and PostgreSQL · Gerald&#39;s Journal</title>



<link rel="stylesheet" href="/css/rocinante.css" />
<link rel="shortcut icon" href="https://i.ibb.co/YNRSK0Z/gerald-logo.png">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

<body>
    <header><h2>
  
    <a href="https://geraldmokereke.xyz/">‹ Gerald&#39;s Journal</a>
  
</h2>
</header>
    <main>

    <div class="post">
      
        <div class="title-group">
            <div class="title">
                <h1>How to Dockerize Spring Boot and PostgreSQL</h1>
            </div>
            <div class="date"><h5>Feb 21, 2023</h5></div>
        </div>
              
        <article class="content">
            <h1 id="introduction">Introduction.</h1>
<p>In this article, I will walk you through the entire process of dockerizing a Spring Boot application, and connecting it to a PostgreSQL database which would be spun up in a seperate container. I assume you have a little knowledge of <a href="https://docker.com" target="_blank">Docker</a>. I initially planned to do a Docker tutorial. I think at the time of writing this&ndash;I have a draft on medium about it. Expect an article soon based on Docker.</p>
<h3 id="getting-started">Getting Started.</h3>
<p><a href="https://docker.com" target="_blank">Docker</a> is a pretty useful tool that lets you bundle your applications into things called &ldquo;images&rdquo; which houses your application files and dependencies. It lets you run the application within those images as a &ldquo;container&rdquo; which is an isolated virtual environment, otherwise layer on your operating system.</p>
<p>Recently, I spun up an Ubuntu docker image which I accessed by entering into the container. It is an awesome tool that would let you save money and run multiple applications simultaneously.</p>
<p>To get started, you would need a machine running Linux preferrably. This is because when Docker was developed, it was done with the Linux operating system in mind as the target platform. I personally fancy Debian distributions, specifically Ubuntu.</p>
<p>If you use Windows, that is pretty fantastic! You could use the popular <a href="https://learn.microsoft.com/en-us/windows/wsl/install" target="_blank">Windows Subsystem for Linux</a>. This is an amazing feature Windows included that would let you run Linux on top of Windows, therefore utilize the power of Docker and Docker Desktop.</p>
<p>If you use MacOS, do not fret! All you require is the Docker Desktop application. It is really ironic that despite Apple&rsquo;s MacOS being based on the Unix kernel which is similar to Linux it isn&rsquo;t natively supported by Docker. If you use a Mac, <a href="https://desktop.docker.com/mac/main/amd64/Docker.dmg?utm_source=docker&amp;utm_medium=webreferral&amp;utm_campaign=dd-smartbutton&amp;utm_location=module" target="_blank">download the Docker Desktop for Mac OS X</a>.</p>
<h3 id="installing-docker">Installing Docker.</h3>
<p>I will be focusing on Linux users here, since all you need to do for Mac and Windows is run a setup or installation file to get it up quickly.</p>
<ol>
<li>Firstly if you have an Old version of Docker, you may need to uninstall:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get remove docker docker-engine docker.io containerd runc
</span></span></code></pre></div><ol start="2">
<li>Update your <code>apt</code> package-index:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get update
</span></span><span style="display:flex;"><span>$ sudo apt-get install <span style="color:#8045ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#8045ff"></span>    ca-certificates <span style="color:#8045ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#8045ff"></span>    curl <span style="color:#8045ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#8045ff"></span>    gnupg <span style="color:#8045ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#8045ff"></span>    lsb-release
</span></span></code></pre></div><ol start="3">
<li>Include Docker&rsquo;s official GPG Key:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo mkdir -m <span style="color:#ae81ff">0755</span> -p /etc/apt/keyrings
</span></span><span style="display:flex;"><span>curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span style="color:#111">|</span> sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
</span></span></code></pre></div><ol start="4">
<li>Set up the registry for Docker:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ <span style="color:#111">echo</span> <span style="color:#8045ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#8045ff"></span>  <span style="color:#d88200">&#34;deb [arch=</span><span style="color:#00a8c8">$(</span>dpkg --print-architecture<span style="color:#00a8c8">)</span><span style="color:#d88200"> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
</span></span></span><span style="display:flex;"><span><span style="color:#d88200">  </span><span style="color:#00a8c8">$(</span>lsb_release -cs<span style="color:#00a8c8">)</span><span style="color:#d88200"> stable&#34;</span> <span style="color:#111">|</span> sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</span></span></code></pre></div><ol start="5">
<li>Update the apt package-index:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo chmod a+r /etc/apt/keyrings/docker.gpg
</span></span><span style="display:flex;"><span>$ sudo apt-get update
</span></span></code></pre></div><ol start="6">
<li>Setup and install the docker engine after satisfying the above requirements:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
</span></span></code></pre></div><h3 id="setting-up-java">Setting Up Java.</h3>
<p>You would need to set up Java on your system. To do this, you would need to install the Java Development Kit. To do this, run the following command: <code>brew install openjdk@19</code> (MacOS) or <code>sudo apt install openjdk@19</code> (Linux). If you use windows, kindly visit <a href="https://oracle.com" target="_blank">Oracle</a> to download the Java Development Kit.</p>
<p>If you use Windows, visit Apache Maven&rsquo;s site to install it. Then add it to your environment variable path.</p>
<h3 id="installing-maven">Installing Maven.</h3>
<p>Maven is a build tool that is used for building Java packages and dependencies. It is very much similar to gradle, which you must have used or heard of before if you have done something like Android development. Here we would be using Maven. Java is a dependency for Maven. To install Maven, run the following command:
<code>brew install mvn</code> (MacOS) or <code>sudo apt install mvn</code>.</p>
<h3 id="setting-up-spring-boot">Setting Up Spring Boot.</h3>
<p><a href="https://spring.io" target="_blank">Spring Boot</a> is a popular MVC framework that was used to simplify the development of applications in the Java Programming Language that was hard to do with the intial Spring MVC framework. It is one of the most preferred means of developing web applications in Java and is used widely in enterprise organizations, banking institutions and major payment infrastructure.</p>
<p>This isn&rsquo;t a spring crash course, so we&rsquo;re going to do something pretty simple. There are two ways to go about this. One, we use <a href="https://spring.io" target="_blank">Spring Boot&rsquo;s quickstart</a> to generate our spring boot application, otherwise we use the Spring Boot Extension in Visual Studio code, which I use and is pretty amazing. You could get it <a href="https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-spring-initializr" target="_blank">here</a></p>
<p>The version we would be playing with at this time is <code>3.0.0+</code>.</p>
<blockquote>
<p>Any version you would want to use works fine, the main deal is getting our Spring Boot application and PostgreSQL containers up. Type in &ldquo;spring-docker-postgres&rdquo; as the demo and artifcat for the project.</p>
</blockquote>
<p>Select &ldquo;Jar&rdquo; as the format which our application would be bundled into. You could skip the dependency aspects. We&rsquo;ll add those later. Also select Java 19 as the version to use for the project.</p>
<p>Once you have generated your project file, open it up either in Visual Studio Code or Intelli J. The next thing you would have to do, is select your dependencies and strap them onto your <code>pom.xml</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-security<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.postgresql<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>postgresql<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;scope&gt;</span>runtime<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.projectlombok<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>lombok<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;optional&gt;</span>true<span style="color:#f92672">&lt;/optional&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-test<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;scope&gt;</span>test<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.security<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-security-test<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;scope&gt;</span>test<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><p>Update the package repostory using Maven, the build tool which we previously installed.</p>
<!-- ### Creating a Simple Spring Method.

Create a new file in your `src/main/java/com/spring-docker-postgres/spring-docker-postgres/` by running the following command: `mkdir example && cd example && touch ExampleController.java`. Once that is done, populate the file with the following:

`ExampleController.java`
```java
package com.spring_docker_postgres.spring_docker_postgres.example;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api/v1/example")
public class ExampleController {
 @GetMapping
 public ResponseEntity<String> exampleController() {
  return ResponseEntity.ok("Testing the api.");
 }
}
```

Define your application properties: -->
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.datasource.url</span><span style="color:#f92672">=</span><span style="color:#d88200">jdbc:postgresql://localhost:5432/example</span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.datasource.username</span><span style="color:#f92672">=</span><span style="color:#d88200">postgres</span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.datasource.password</span><span style="color:#f92672">=</span><span style="color:#d88200">postgres</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.jpa.show-sql</span><span style="color:#f92672">=</span><span style="color:#d88200">true</span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.jpa.hibernate.ddl-auto</span><span style="color:#f92672">=</span><span style="color:#d88200">update</span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.jpa.properties.hibernate.dialect</span><span style="color:#f92672">=</span><span style="color:#d88200">org.hibernate.dialect.PostgreSQLDialect</span>
</span></span><span style="display:flex;"><span><span style="color:#75af00">spring.jpa.properties.hibernate.format_sql</span><span style="color:#f92672">=</span><span style="color:#d88200">true</span>
</span></span></code></pre></div><p>Execute the command: <code>mvn spring-boot:run</code> or run the project from your IDE. Using an API Testing client such as Postman or Insonmia, test the following endpoint to see the response: <code>http://localhost:8080/api/v1/example</code>. That should return the above response in a string, as JSON format within the response body.</p>
<h3 id="dockerizing-our-application">Dockerizing our Application.</h3>
<p>So generally Spring Boot applications are deployed or built into production into a format called <code>Jar</code> or <code>War</code>. We selected <code>Jar</code> initially. In order to build our application into a <code>jar</code> file, we would need to run the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ./mvnw clean package -DskipTests
</span></span></code></pre></div><p>We added the flag <code>-DskipTests</code> to just skip tests and get to the chase. I do not recommend you do this when building a <code>jar</code> so you catch the errors and avoid shipping bugs into production
We should have our newly created <code>.jar</code> stored in our target folder!</p>
<p>It is usually stored in a folder known as <code>target/</code> which is in your project&rsquo;s directory. I recommend you copy the jar file from the target folder into your root directory. <code>sudo cp /target/&lt;jar-file&gt;.jar /&lt;destination&gt;/</code></p>
<h3 id="creating-the-docker-image">Creating the Docker image.</h3>
<p>A docker image is like potential energy. It&rsquo;s a container at rest packaged with all application dependencies required to run our application. To build an image, we would have to define the contents using something called a <code>Dockerfile.</code> Create a file called <code>Dockerfile</code>. No extension, just a file: <code>touch Dockerfile</code>. Depending on your IDE, you should see a blueish or pink whale icon carrying some boxes. Now, we define the contents:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="display:flex;"><span><span style="color:#00a8c8">FROM</span> <span style="color:#d88200">openjdk:19</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#00a8c8">ARG</span> <span style="color:#111">JAR_FILE</span><span style="color:#f92672">=</span>*.jar<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#00a8c8">COPY</span> <span style="color:#d88200">${</span><span style="color:#111">JAR_FILE</span><span style="color:#d88200">}</span> application.jar<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#00a8c8">ENTRYPOINT</span> <span style="color:#111">[</span><span style="color:#d88200">&#34;java&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;-jar&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;application.jar&#34;</span><span style="color:#111">]</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Here, using <code>FROM</code> we get the OpenJdk@19 installed on our image. We copy the <code>jar</code> file into our image and add an Entrypoint. Then we save the file. Instead of building the image right away, we would use a container orchestration tool known as docker-compose which we installed previously in this article.</p>
<h3 id="using-docker-compose">Using Docker-Compose.</h3>
<p>Docker-Compose is a utility used to automate and orchestrate the deployment, management and building of docker images to docker containers. To use docker-compose, we need to create a <code>docker-compose.yml</code> file.</p>
<p>Append the following configurations:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;3.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">API</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;:latest&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">build</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">context</span><span style="color:#111">:</span> <span style="color:#ae81ff">.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#d88200">&#34;8080:8080&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span><span style="color:#111">:</span> <span style="color:#ae81ff">spring_docker-postgres</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Database</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">condition</span><span style="color:#111">:</span> <span style="color:#ae81ff">service_healthy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_URL=jdbc:postgresql://Database:5432/example</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_USERNAME=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_PASSWORD=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_JPA_HIBERNATE_DDL_AUTO=update</span>
</span></span></code></pre></div><p>Here we instruct docker-compose to build our spring boot image into a container called &ldquo;api&rdquo; and provide the context, otherwise dockerfile to acheive this. We also assign ports and create the environment variables for the project.</p>
<h3 id="wheres-our-postgres-database">Where&rsquo;s our postgres database?</h3>
<blockquote>
<p>This is where it gets interesting. We do not need a local database!
Docker gives us the power to create and run an instance of PostgreSQL within a container by pulling the image off the registry without having postgres installed locally. To do this we use compose once more.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>  <span style="color:#f92672">Database</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;postgres:13.1-alpine&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#d88200">&#34;5432&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span><span style="color:#111">:</span> <span style="color:#ae81ff">sdp_database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_PASSWORD=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_USER=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_DB=example</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">healthcheck</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">test</span><span style="color:#111">:</span> <span style="color:#111">[</span> <span style="color:#d88200">&#34;CMD-SHELL&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;pg_isready -U postgres&#34;</span> <span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">interval</span><span style="color:#111">:</span> <span style="color:#ae81ff">10s</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">timeout</span><span style="color:#111">:</span> <span style="color:#ae81ff">5s</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">retries</span><span style="color:#111">:</span> <span style="color:#ae81ff">5</span>
</span></span></code></pre></div><p>The &ldquo;spd&rdquo; is just a self coined abbreviation for spring-docker-postgres. Call it whatever you like!</p>
<h3 id="running-the-containers">Running the containers.</h3>
<p>Your compose file should look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;3.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">API</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;:latest&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">build</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">context</span><span style="color:#111">:</span> <span style="color:#ae81ff">.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#d88200">&#34;8080:8080&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span><span style="color:#111">:</span> <span style="color:#ae81ff">spring_docker-postgres</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">Database</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">condition</span><span style="color:#111">:</span> <span style="color:#ae81ff">service_healthy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_URL=jdbc:postgresql://Database:5432/example</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_USERNAME=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_DATASOURCE_PASSWORD=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">SPRING_JPA_HIBERNATE_DDL_AUTO=update</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">Database</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;postgres:13.1-alpine&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#d88200">&#34;5432&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span><span style="color:#111">:</span> <span style="color:#ae81ff">sdp_database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_PASSWORD=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_USER=postgres</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">POSTGRES_DB=example</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">healthcheck</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">test</span><span style="color:#111">:</span> <span style="color:#111">[</span> <span style="color:#d88200">&#34;CMD-SHELL&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;pg_isready -U postgres&#34;</span> <span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">interval</span><span style="color:#111">:</span> <span style="color:#ae81ff">10s</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">timeout</span><span style="color:#111">:</span> <span style="color:#ae81ff">5s</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">retries</span><span style="color:#111">:</span> <span style="color:#ae81ff">5</span>
</span></span></code></pre></div><p>Now the command we&rsquo;ve all been waiting for! Run <code>docker-compose up</code> Then visit the assigned ports on your localhost. Congratulations, you have dockerized Spring and Postgres!</p>

        </article>
        
    </article>


    </main>
    <footer>
  <div class="content-container">
    <div class="content">I&rsquo;m Gerald Maduabuchi Okereke. Welcome to my thoughts, my journal and my little space on the web.


  <p class="horizontal-links"><a href="https://github.com/grayoj"
        target="_blank" 
       
      >Github</a><a href="https://twitter.com/geraldmokereke"
        target="_blank" 
       
      >X</a><a href="mailto:geraldmokereke@gmail.com"
        target="_blank" 
       
      >Email</a></p>

</div>
  </div>
</footer>
    
    <script>
      const emailId = atob("bWFpbEBleGFtcGxlLmNvbQ==");
    </script>
      <script src="/js/rocinante.min.js"></script></body>
</html>
